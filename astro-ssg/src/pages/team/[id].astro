---
import type { GetStaticPaths } from "astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";

import BaseLayout from "@/layouts/BaseLayout.astro";

export const getStaticPaths = (async () => {
  const authors = await getCollection("authors");

  return authors.map((author) => ({
    params: {
      id: author.id,
    },
    props: {
      author,
    },
  }));
}) satisfies GetStaticPaths;

const { id } = Astro.params;
const { author } = Astro.props;
---

<BaseLayout title={`${id}`}>
  <div class="mx-auto mt-24 max-w-2xl p-5">
    <div class="flex items-center justify-start gap-3">
      {
        typeof author.data.avatar === "string" && author.data.avatar && (
          <Image
            src={author.data.avatar}
            alt={author.data.firstname}
            width={128}
            height={128}
            class="size-12 rounded-full"
          />
        )
      }
      {
        typeof author.data.avatar === "object" && author.data.avatar && (
          <Image
            src={author.data.avatar.src}
            alt={author.data.email}
            width={author.data.avatar.width}
            height={author.data.avatar.height}
            class="size-12 rounded-full"
          />
        )
      }
      <div class="flex flex-col">
        <h3 class="mb text-xl font-bold">
          {`${author.data.firstname} ${author.data.lastname}`}
        </h3>
        <p class="text-xs">{author.data.email}</p>
      </div>
    </div>
    <p class="mt-3 text-muted-foreground">{author.data.bio}</p>
  </div>
</BaseLayout>
