---
import Copyright from "@/components/utility/Copyright";
import { getCollection } from "astro:content";
import BackToTopButton from "@/components/utility/BackToTopButton";
import { ArrowUpIcon } from "lucide-react";
import {
  extractLangFromUri,
  translateUri,
  useTranslations,
} from "@/i18n/utils";

interface Props {
  className?: string;
}

const [lang] = extractLangFromUri(Astro.url);
const t = useTranslations(lang);

const legal = await getCollection("legal", ({ slug }) => slug.startsWith(lang));

const { className } = Astro.props;
---

<footer class:list={["relative", className]}>
  <section class="py-5">
    <div class="container">
      <div class="flex items-center justify-center sm:justify-end">
        <BackToTopButton
          size={"sm"}
          variant={"outline"}
          className="flex items-center justify-center gap-2"
          client:visible
        >
          {t("component.footer.button.back-to-top")}
          <ArrowUpIcon className="size-4" />
        </BackToTopButton>
      </div>
    </div>
  </section>

  <section
    class="overflow-hidden whitespace-nowrap border-t border-foreground/10 py-16"
  >
    <div class="container">
      <div class="flex items-end justify-between gap-1">
        <div class="flex flex-col gap-1.5">
          <Copyright client:load />
          <nav
            class="flex flex-wrap items-center gap-1.5 text-muted-foreground"
          >
            {
              legal.map((page) => (
                <Fragment>
                  <a
                    href={translateUri(`/legal/${page.slug}`, lang)}
                    class="text-sm transition-colors hover:text-foreground"
                  >
                    {page.data.title}
                  </a>
                  <span class="last:hidden">|</span>
                </Fragment>
              ))
            }
          </nav>
        </div>

        <!-- Logo -->
        <div>
          <a
            href="/"
            class="flex items-center justify-start gap-3"
            aria-label="Research Portal"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 128 128"
              class="size-8 fill-primary"
            >
              <path
                d="M50.4 78.5a75.1 75.1 0 0 0-28.5 6.9l24.2-65.7c.7-2 1.9-3.2 3.4-3.2h29c1.5 0 2.7 1.2 3.4 3.2l24.2 65.7s-11.6-7-28.5-7L67 45.5c-.4-1.7-1.6-2.8-2.9-2.8-1.3 0-2.5 1.1-2.9 2.7L50.4 78.5Zm-1.1 28.2Zm-4.2-20.2c-2 6.6-.6 15.8 4.2 20.2a17.5 17.5 0 0 1 .2-.7 5.5 5.5 0 0 1 5.7-4.5c2.8.1 4.3 1.5 4.7 4.7.2 1.1.2 2.3.2 3.5v.4c0 2.7.7 5.2 2.2 7.4a13 13 0 0 0 5.7 4.9v-.3l-.2-.3c-1.8-5.6-.5-9.5 4.4-12.8l1.5-1a73 73 0 0 0 3.2-2.2 16 16 0 0 0 6.8-11.4c.3-2 .1-4-.6-6l-.8.6-1.6 1a37 37 0 0 1-22.4 2.7c-5-.7-9.7-2-13.2-6.2Z"
              ></path>
            </svg>
            <h3 class="hidden font-bold md:block">Research Portal</h3>
          </a>
        </div>
      </div>
    </div>
  </section>
</footer>
